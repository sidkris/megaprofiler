import pytest
import pandas as pd
from megaprofiler.megaprofiler import MegaProfiler
from megaprofiler.data_validator import DataValidator

def test_profiler():
    data = pd.DataFrame({
        'age': [25, 30, None],
        'name': ['Alice', 'Bob', 'Charlie']
    })
    profiler = MegaProfiler(data)
    profile = profiler.profile()
    
    assert 'age' in profile['columns']
    assert profile['missing_values']['age'] == 1

def test_validator():
    data = pd.DataFrame({
        'age': [25, 30, None],
        'name': ['Alice', 'Bob', 'Charlie']
    })
    validator = DataValidator(data)
    rules = [{'column': 'age', 'condition': 'no_missing', 'message': 'Age has missing values.'}]
    violations = validator.validate(rules)
    
    assert len(violations) == 1
    assert violations[0] == 'Age has missing values.'
