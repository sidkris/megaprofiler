from megaprofiler.megaprofiler import MegaProfiler
import pandas as pd

# Example DataFrame and rules
df = pd.DataFrame({
    'age': [25, 30, 45, None],
    'name': ['Alice', 'Bob', 'Charlie', 'David']
})

rules = [
    {'column': 'age', 'condition': 'no_missing', 'message': 'Age column contains missing values.'},
    {'column': 'age', 'condition': 'range', 'min': 0, 'max': 120, 'message': 'Age must be a number between 0 and 120.'},
]

# Generate profile and summary
profile_report, rule_violations = MegaProfiler.summarize(df, rules)

print(profile_report)
print(rule_violations)
